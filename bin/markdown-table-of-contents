#!/usr/bin/env ruby
require "sixarm_ruby_markdown_table_of_contents"
begin
  settings = SixArm::Markdown::TOC::Settings.new
  settings.option_parsing
  generator = SixArm::Markdown::TOC::Generator.new(settings: settings)
  ARGV.each{|markdown_file_path| 
    file = SixArm::Markdown::File.new(markdown_file_path)
    input = file.slurp
    output = generator.rewrite_toc(input)
    file.rewrite(output)
  }
  exit 0
rescue
  STDERR.puts "Error! " + $!.message
  exit 1
end
